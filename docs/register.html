<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Register â€“ Music Project</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body class="bg-light">
    <div
      class="container d-flex justify-content-center align-items-center vh-100"
    >
      <div class="card p-4 shadow" style="width: 400px">
        <h3 class="text-center mb-4">Register</h3>

        <form id="registerForm">
          <div class="mb-3">
            <label class="form-label">Username *</label>
            <input type="text" id="username" class="form-control" required />
          </div>

          <div class="mb-3">
            <label class="form-label">Private Name *</label>
            <input type="text" id="privateName" class="form-control" required />
          </div>

          <div class="mb-3">
            <label class="form-label">Profile Picture URL *</label>
            <input type="url" id="avatar" class="form-control" required />
          </div>

          <div class="mb-3">
            <label class="form-label">Password *</label>
            <input
              type="password"
              id="password"
              class="form-control"
              required
            />
          </div>

          <div class="mb-3">
            <label class="form-label">Verify Password *</label>
            <input
              type="password"
              id="verifyPassword"
              class="form-control"
              required
            />
          </div>

          <div class="d-grid">
            <button type="submit" class="btn btn-success">Register</button>
          </div>

          <p class="text-danger text-center mt-3" id="errorMsg"></p>

          <p class="text-center mt-3">
            Already registered?
            <a href="login.html">Login</a>
          </p>
        </form>
      </div>
    </div>

    <script>
      const form = document.getElementById("registerForm");
      const errorMsg = document.getElementById("errorMsg");

      form.addEventListener("submit", function (e) {
        e.preventDefault();

        const username = document.getElementById("username").value.trim();
        const privateName = document.getElementById("privateName").value.trim();
        const avatar = document.getElementById("avatar").value.trim();
        const password = document.getElementById("password").value;
        const verifyPassword = document.getElementById("verifyPassword").value;

        // Load existing users
        const users = JSON.parse(localStorage.getItem("users")) || [];

        // ðŸ” Username uniqueness check
        if (users.some((u) => u.username === username)) {
          errorMsg.textContent = "Username already exists";
          return;
        }

        // Password validation
        const passwordRegex = /^(?=.*[A-Za-z])(?=.*\d)(?=.*[^A-Za-z\d]).{6,}$/;
        if (!passwordRegex.test(password)) {
          errorMsg.textContent =
            "Password must be at least 6 characters and include a letter, number, and symbol";
          return;
        }

        // Password match check
        if (password !== verifyPassword) {
          errorMsg.textContent = "Passwords do not match";
          return;
        }

        // Create new user
        const newUser = {
          username,
          privateName,
          password,
          avatar,
        };

        users.push(newUser);

        // Save to localStorage
        localStorage.setItem("users", JSON.stringify(users));

        // âž¡ Redirect to login
        window.location.href = "login.html";
      });
    </script>
  </body>
</html>
